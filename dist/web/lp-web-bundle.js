!function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=23)}([function(e,t){e.exports=require("max-api")},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.push="push",e.release="release",e.hold="hold",e.holdRelease="holdRelease",e.longHold="longHold",e.longHoldRelease="longHoldRelease",e.doubleTap="doubleTap",e.midiEvent="midiEvent"}(i||(i={})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{static getXYButton(e,t){return 16*e+t}static getRowCol(e){let t;return t=[Math.floor(e/16),e%16],t}static parseColor(e){return this.colors[e]}static getXYButtonMidiBytes(e,t){return this.xyButtonMap.get(e+" "+t)}static getXYButtonRowColFromMidiBytes(e,t){let n=[];return this.xyButtonMap.forEach((i,s)=>{if(i[0]===e&&i[1]===t){let e=s.split(" ");n[0]=parseInt(e[0]),n[1]=parseInt(e[1])}}),n}}i.launchpadConfig=n(10),i.xyButtonMap=function(){let e=new Map,t=n(11);for(let n=0;n<8;n++){let i=t[""+n];for(let t=0;t<8;t++){let s=i[""+t];e.set(n+" "+t,s)}}return e}(),i.colors={off:12,"red-low":13,red:15,"red-flash":11,"amber-low":29,amber:63,"amber-flash":59,yellow:62,"yellow-flash":58,"green-low":28,green:60,"green-flash":56},t.default=i},function(e,t,n){var i=n(17),s=Object.prototype.toString,r="win32"===process.platform;function o(e){return"[object Object]"===s.call(e)}function l(e,t){var n;for(var i in t)n=t[i],Array.isArray(n)?(Array.isArray(e[i])||(e[i]=[]),l(e[i],n)):o(n)?(o(e[i])||(e[i]={}),l(e[i],n)):e[i]=n;return e}if(["Function","String","Number","Date","RegExp"].forEach((function(e){t["is"+e]=function(t){return s.call(t)==="[object "+e+"]"}})),l(t,i),t.isObject=o,t.extend=function(){var e=Array.prototype.slice.call(arguments,0),t=e.shift();return e.forEach((function(e){l(t,e)})),t},t.isArray=Array.isArray,t.isUndefined=function(e){return void 0===e},t.noop=function(){},t.unique=function(e){var t=[];return e.forEach((function(e){-1==t.indexOf(e)&&t.push(e)})),t},t.escape=function(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},t.unescape=function(e){return String(e).replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">")},t.hrtime=function(e){if(e){var t=process.hrtime(e);return t=1e3*(t[0]+t[1]/1e9)+"ms"}return process.hrtime()},t.pick=function(e,n){var i={};if(t.isFunction(n))for(var s in e){var r=e[s];n(r,s,e)&&(i[s]=r)}else{var o=Array.prototype.slice.call(arguments,1);o.forEach((function(t){t in e&&(i[t]=e[t])}))}return i},t.path={},r){var a=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/;t.path.isAbsolute=function(e){var t=a.exec(e),n=t[1]||"",i=!!n&&":"!==n.charAt(1);return!!t[2]||i},t.path.unixifyPath=function(e){return e.replace(/\\/g,"/")}}else t.path.isAbsolute=function(e){return"/"===e.charAt(0)},t.path.unixifyPath=function(e){return e}},function(e,t,n){"use strict";(function(e){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(5)),r=i(n(6));var o=n(15);t.default=class{constructor(t,n,i,s,r){this.scenes=[],this.curSceneIdx=0,this.midiIn=t,this.toLaunchpad=n,this.midiOut=i,this.textOut=s,r=null!=r&&null!=r&&""!=r?r:"launchpad_scenes.json",console.log(e),this.loadScenes(r),this.reset()}loadScenes(e){let t;o.readFile(e,(n,i)=>{n?console.log("Error reading "+e):(t=JSON.parse(i.toString()),this.parseSceneJson(t))})}parseSceneJson(e){void 0!==e.scenes&&e.scenes.forEach(e=>this.scenes.push(new r.default(this.midiIn,this.toLaunchpad,e))),console.log("Cursceneidx: "+this.curSceneIdx)}handleMidiMessage(e){this.scenes[this.curSceneIdx].handleMidiEvent(e)}reset(){this.toLaunchpad.send(s.default.reset)}lowBrightnessTest(){this.toLaunchpad.send(s.default.lowBrightnessTest)}mediumBrightnessTest(){this.toLaunchpad.send(s.default.mediumBrightnessTest)}fullBrightnessTest(){this.toLaunchpad.send(s.default.fullBrightnessTest)}}}).call(this,"/")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{}i.reset="176 0 0",i.xyGridLayout="176 0 1",i.drumRackLayout="176 0 2",i.lowBrightnessTest="176 0 125",i.mediumBrightnessTest="176 0 126",i.fullBrightnessTest="176 0 127",t.default=i},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(7)),r=i(n(8));t.default=class{constructor(e,t,n){this.sceneName="",this.sceneIndex=0,this.handlers=[],this.midiIn=e,this.toLaunchpad=t,this.loadScene(n)}handleMidiEvent(e){let t=e.split(" ").map(e=>parseInt(e)),n=new s.default(t,Date.now()),i=this.handlers.find(e=>e.midiBytes[0]===t[0]&&e.midiBytes[1]===t[1]);void 0!==i&&i.handleEvent(n)}notify(e){console.log("Notify...");let t=this.constructToLaunchpadMessage(e);this.toLaunchpad.send(t),this.sendSideEffects(e)}constructToLaunchpadMessage(e){return console.log("Handler: "+e),console.log("Curhandlerstate: "+e.curHandlerState),e.midiBytes[0]+" "+e.midiBytes[1]+" "+e.curHandlerState.colorCode}sendSideEffects(e){e.curHandlerState.sideEffects.forEach(e=>{})}loadScene(e){this.sceneName=void 0!==e.sceneName?e.sceneName:this.sceneName,this.sceneIndex=void 0!==e.sceneIndex?e.sceneIndex:this.sceneIndex,(void 0!==e.handlers?e.handlers:[]).forEach(e=>{r.default.loadHandlers(e).forEach(e=>{e.subscribe(this),this.handlers.push(e)})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.midiBytes=[],this.timestamp=0,e.forEach((e,t)=>{this.midiBytes[t]=e}),this.timestamp=t}}},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(9)),r=i(n(12)),o=i(n(13)),l=i(n(2)),a=i(n(1)),u=i(n(14));class c{static loadHandlers(e){let t=[],n=r.default.midi;switch(e.type){case"xyButton":n=r.default.xyButton;break;case"menuButton":n=r.default.menuButton;break;case"launchButton":n=r.default.launchButton;break;case"midi":n=r.default.midi}if(n===r.default.xyButton){let n=void 0!==e.row?e.row:"all",i=void 0!==e.col?e.col:"all",r=[],o=[];if("number"==typeof n&&r.push(n),"number"==typeof i&&o.push(i),"all"===n)for(let e=0;e<8;e++)r.push(e);if("all"===i)for(let e=0;e<8;e++)o.push(e);r.forEach(e=>{o.forEach(n=>{let i=l.default.getXYButtonMidiBytes(e,n),r=new s.default;r.setMidiBytes(i),t.push(r)})})}else n===r.default.launchButton||r.default.menuButton;return t.forEach(t=>{let n=[];(void 0!==e.handlerStates?e.handlerStates:[]).forEach(e=>{let i=c.loadHandlerState(e,t);n.push(i)}),t.setHandlerStates(n)}),t}static loadHandlerState(e,t){let n=new o.default,i=void 0!==e.index?e.index:0;n.setIndex(i);let s=void 0!==e.color?e.color:"off",r=l.default.parseColor(s);r=void 0!==e.colorCode?e.colorCode:r,n.setColorCode(r);let a=void 0!==e.transitions?e.transitions:[],u=c.loadTransitions(a);n.setTransitions(u);let d=void 0!==e.sideEffects?e.sideEffects:[],f=c.loadSideEffects(d,t);return n.setSideEffects(f),n}static loadTransitions(e){let t=new Map;return e.forEach(n=>{let i=void 0!==n.eventType?e.interaction:"midiEvent",s=a.default.midiEvent;switch(i){case"push":s=a.default.push;break;case"release":s=a.default.release;break;case"hold":s=a.default.hold;break;case"holdRelease":s=a.default.holdRelease;break;case"longHold":s=a.default.longHold;break;case"longHoldRelease":s=a.default.longHoldRelease;break;case"doubleTap":s=a.default.doubleTap;break;case"midiEvent":s=a.default.midiEvent}let r=n.toIndex;t.set(s,r)}),t.forEach((e,t)=>{console.log("transition: "+t+" "+e)}),t}static loadSideEffects(e,t){let n=[];return e.forEach(e=>{let i=void 0!==e.row?e.row:"all",s=void 0!==e.col?e.col:"all",r=void 0!==e.color?e.color:"off",o=l.default.parseColor(r);o=void 0!==e.colorCode?e.colorCode:o;let a=void 0!==e.delay?e.delay:0,c=[],d=[],f=l.default.getXYButtonRowColFromMidiBytes(t.midiBytes[0],t.midiBytes[1]);if("number"==typeof i)c.push(i);else if("all"===i)for(let e=0;e<8;e++)c.push(e);else if("same"===i){let e=f[0];c.push(e)}if("number"==typeof s)d.push(s);else if("all"===s)for(let e=0;e<8;e++)d.push(e);else if("same"===s){let e=f[1];d.push(e)}c.forEach(e=>{d.forEach(t=>{if(e!==f[0]||t!==f[1]){let i=new u.default,s=l.default.getXYButtonMidiBytes(e,t);i.setMidiBytes(s),i.setDelay(a),i.setColorCode(o),n.push(i)}})})}),n}}t.default=c},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(1)),r=i(n(2));t.default=class{constructor(){this.type=null,this.midiBytes=[],this.handlerStates=[],this.curHandlerState=null,this.handlerEvents=[],this.subscribers=[]}setType(e){this.type=e}setMidiBytes(e){e.forEach((e,t)=>{this.midiBytes[t]=e})}setHandlerStates(e){this.handlerStates=[],e.forEach(e=>{this.handlerStates.push(e)});let t=this.handlerStates[0].index;this.handlerStates.forEach(e=>t=Math.min(t,e.index)),console.log("this.handlerStates.length: "+this.handlerStates.length),this.curHandlerState=this.handlerStates.find(e=>e.index===t),console.log("this.curHandlerState: "+this.curHandlerState)}subscribe(e){this.subscribers.push(e)}handleEvent(e){let t=this.curHandlerState.clone();e.midiBytes[2]>0?(this.publishEvent(s.default.push,t),this.handlerEvents[1].midiBytes[2]>0&&e.timestamp-this.handlerEvents[1].timestamp>r.default.launchpadConfig.doubleTapTime&&this.publishEvent(s.default.doubleTap,t),setTimeout(()=>{this.handlerEvents[0].midiBytes[2]>0&&this.publishEvent(s.default.hold,t)},r.default.launchpadConfig.holdTime),setTimeout(()=>{this.handlerEvents[0].midiBytes[2]>0&&this.publishEvent(s.default.longHold,t)},r.default.launchpadConfig.longHoldTime)):(this.publishEvent(s.default.release,t),this.handlerEvents[0].midiBytes[2]>0&&e.timestamp-this.handlerEvents[0].timestamp>r.default.launchpadConfig.holdTime&&this.publishEvent(s.default.holdRelease,t),this.handlerEvents[0].midiBytes[2]>0&&e.timestamp-this.handlerEvents[0].timestamp>r.default.launchpadConfig.longHoldTime&&this.publishEvent(s.default.longHoldRelease,t)),this.handlerEvents.unshift(e),this.handlerEvents.length>4&&(this.handlerEvents=this.handlerEvents.slice(0,4))}publishEvent(e,t){let n=t.transitions.get(e);console.log("nextHandlerStateIdx: "+n),this.curHandlerState=this.handlerStates.find(e=>e.index===n),this.subscribers.forEach(e=>{console.log("publishEvent this.curHandlerState: "+this.curHandlerState),e.notify(this)})}doTransitionState(e){let t=this.curHandlerState.getNextEventStateIndex(e),n=this.handlerStates.find(e=>e.index===t);return this.curHandlerState=n,this.curHandlerState}}},function(e){e.exports=JSON.parse('{"holdTime":1500,"longHoldTime":2500}')},function(e){e.exports=JSON.parse('{"0":{"0":[144,0],"1":[144,1],"2":[144,2],"3":[144,3],"4":[144,4],"5":[144,5],"6":[144,6],"7":[144,7]},"1":{"0":[144,16],"1":[144,17],"2":[144,18],"3":[144,19],"4":[144,20],"5":[144,21],"6":[144,22],"7":[144,23]},"2":{"0":[144,32],"1":[144,33],"2":[144,34],"3":[144,35],"4":[144,36],"5":[144,37],"6":[144,38],"7":[144,39]},"3":{"0":[144,48],"1":[144,49],"2":[144,50],"3":[144,51],"4":[144,52],"5":[144,53],"6":[144,54],"7":[144,55]},"4":{"0":[144,64],"1":[144,65],"2":[144,66],"3":[144,67],"4":[144,68],"5":[144,69],"6":[144,70],"7":[144,71]},"5":{"0":[144,80],"1":[144,81],"2":[144,82],"3":[144,83],"4":[144,84],"5":[144,85],"6":[144,86],"7":[144,87]},"6":{"0":[144,96],"1":[144,97],"2":[144,98],"3":[144,99],"4":[144,100],"5":[144,101],"6":[144,102],"7":[144,103]},"7":{"0":[144,112],"1":[144,113],"2":[144,114],"3":[144,115],"4":[144,116],"5":[144,117],"6":[144,118],"7":[144,119]}}')},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.xyButton="xyButton",e.launchButton="launchButton",e.menuButton="menuButton",e.midi="midi"}(i||(i={})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.index=null,this.transitions=new Map,this.colorCode=null,this.sideEffects=[]}clone(){let e=new i;return e.setIndex(this.index),e.setColorCode(this.colorCode),e.setTransitions(this.transitions),e.setSideEffects(this.sideEffects),e}setIndex(e){this.index=e}setColorCode(e){this.colorCode=e}setTransitions(e){this.transitions=new Map,e.forEach((e,t)=>{this.transitions.set(t,e)})}setSideEffects(e){this.sideEffects=[],e.forEach(e=>{this.sideEffects.push(e)})}getNextEventStateIndex(e){return this.transitions.get(e)}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.midiBytes=[],this.colorCode=null,this.delay=null}setMidiBytes(e){e.forEach((e,t)=>{this.midiBytes[t]=e})}setColorCode(e){this.colorCode=e}setDelay(e){this.delay=e}}},function(e,t,n){var i=n(16),s=n(3),r=n(18),o=n(19);function l(e){return i.existsSync(e)?e:l(r.dirname(e))}s.extend(t,i),t.fs=i,t.fileMatch=o,t.mkdir=function(e,t,n){var o=l(e),a=r.relative(o,e);if(s.isFunction(t)&&(n=t,t=null),s.isFunction(n)||(n=s.noop),t=t||511,!a)return n();function u(e){if(u.count===a.length)return n();e=r.join(e,a[u.count]),i.mkdir(e,t,(function(t){u.count++,u(e)}))}a=a.split(r.sep),u.count=0,u(o)},t.mkdirSync=function(e,t){var n=l(e),s=r.relative(n,e);s&&(s=s.split(r.sep)).forEach((function(e){n=r.join(n,e),i.mkdirSync(n,t)}))},t.writeFile=function(e,n,o,l){var a=function(e,t){return s.isFunction(e)?{options:null,callback:e}:s.isObject(e)?{options:e,callback:t}:{options:null,callback:s.noop}}(o,l),u=r.dirname(e);o=a.options,l=a.callback,t.mkdir(u,(function(){i.writeFile(e,n,o,l)}))},t.writeFileSync=function(e,n,s){var o=r.dirname(e);t.mkdirSync(o),i.writeFileSync(e,n,s)},t.copyFile=function(e,n,r){(r=s.extend({encoding:"utf8",done:s.noop},r||{})).process||(r.encoding=null),i.readFile(e,{encoding:r.encoding},(function(e,i){if(e)return r.done(e);r.process&&(i=r.process(i)),t.writeFile(n,i,r,r.done)}))},t.copyFileSync=function(e,n,r){var o;(r=s.extend({encoding:"utf8"},r||{})).process?(o=i.readFileSync(e,r),o=r.process(o,e,r.relative),s.isObject(o)&&o.filepath&&(n=o.filepath,o=o.contents),t.writeFileSync(n,o,r)):(o=i.readFileSync(e),t.writeFileSync(n,o))},t.recurse=function(e,t,n){s.isFunction(t)&&(n=t,t=null);var l=o(t),a=e;!function e(t){i.readdir(t,(function(s,o){if(s)return n(s);o.forEach((function(s){var o=r.join(t,s);i.stat(o,(function(t,i){var u=r.relative(a,o),c=l(u);i.isDirectory()?(e(o),c&&n(o,u)):c&&n(o,u,s)}))}))}))}(e)},t.recurseSync=function(e,t,n){s.isFunction(t)&&(n=t,t=null);var l=o(t),a=e;!function e(t){i.readdirSync(t).forEach((function(s){var o=r.join(t,s),u=i.statSync(o),c=r.relative(a,o),d=l(c);u.isDirectory()?(e(o),d&&n(o,c)):d&&n(o,c,s)}))}(e)},t.rmdirSync=function(e){t.recurseSync(e,(function(e,t,n){n?i.unlinkSync(e):i.rmdirSync(e)})),i.rmdirSync(e)},t.copySync=function(e,n,i){i=s.extend({encoding:"utf8",filter:null,noProcess:""},i||{});var l=o(i.noProcess);t.mkdirSync(n),t.recurseSync(e,i.filter,(function(e,s,o){if(o){var a=r.join(n,s),u={relative:s};i.process&&!l(s)&&(u.encoding=i.encoding,u.process=i.process),t.copyFileSync(e,a,u)}}))}},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("path")},function(e,t,n){var i=n(3);e.exports=function(e,t){if(null===e)return function(){return!0};if(""===e||i.isArray(e)&&!e.length)return function(){return!1};i.isString(e)&&(e=[e]);var n=[],s=[],r=t?"i":"";return e.forEach((function(e){var t=0===e.indexOf("!");e="(^"+(e=e.replace(/^!/,"").replace(/\*(?![\/*])/,"[^/]*?").replace("**/","([^/]+/)*").replace(/\{([^\}]+)\}/g,(function(e,t){var n=t.split(","),i=n.length,s="(?:";return n.forEach((function(e,t){s+="("+e.trim()+")",t+1!==i&&(s+="|")})),s+=")"})).replace(/([\/\.])/g,"\\$1"))+"$)",t?s.push(e):n.push(e)})),n=n.length?new RegExp(n.join("|"),r):null,s=s.length?new RegExp(s.join("|"),r):null,function(e){return e=i.path.unixifyPath(e),(!s||!s.test(e))&&!(!n||!n.test(e))}}},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(0));t.default=class{constructor(e){this.prefix="",null!=e&&null!=e&&""!=e&&(this.prefix=e)}send(e){s.default.outlet(this.prefix+" "+e)}}},function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(0));t.default=class{onMessage(e){s.default.addHandler("from_launchpad",t=>{e(t)})}}},,function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(4)),r=i(n(20)),o=new(i(n(21)).default),l=new r.default(""),a=new r.default(""),u=new r.default("");new s.default(o,l,a,u,"")}]);